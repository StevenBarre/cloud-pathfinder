(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{419:function(e,t,o){e.exports=o.p+"assets/img/11_resources_01.a519d1fc.png"},420:function(e,t,o){e.exports=o.p+"assets/img/11_resources_02.7d77cbd9.png"},421:function(e,t,o){e.exports=o.p+"assets/img/11_resources_03.c24b0cf8.png"},482:function(e,t,o){"use strict";o.r(t);var s=o(32),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"resource-requests-and-limits"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#resource-requests-and-limits"}},[e._v("#")]),e._v(" Resource Requests and Limits")]),e._v(" "),s("p",[e._v("Tuning the resources assigned to a pod will have a direct effect on the performance of the application.")]),e._v(" "),s("p",[e._v("Many templates include reasonable CPU and Memory resource configurations, however, new apps simply are deployed with the platform default.")]),e._v(" "),s("blockquote",[s("p",[e._v("Platform Resource Request defaults are maintained by platform services. It is a measurement based on the average cpu/memory utilization and serves as a great starting point for your pods horsepower")])]),e._v(" "),s("h2",{attrs:{id:"explore-default-resource-configurations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#explore-default-resource-configurations"}},[e._v("#")]),e._v(" Explore Default Resource Configurations")]),e._v(" "),s("p",[e._v("Since the Rocket Chat application was built from scratch and not deployed from a template, explore the current resources allocated to the pods:")]),e._v(" "),s("ul",[s("li",[e._v("Navigate to your rocketchat deploymentconfig and select "),s("code",[e._v("Yaml")])]),e._v(" "),s("li",[e._v("Take a look a the resources spec under "),s("code",[e._v(".spec.template.spec.containers.resources")]),e._v("\nit should be "),s("code",[e._v("{}")]),e._v(". This identifies that it is using the default resource allocation.")])]),e._v(" "),s("p",[s("img",{attrs:{src:o(419),alt:""}})]),e._v(" "),s("ul",[s("li",[e._v("Review the current metrics of your "),s("code",[e._v("rocketchat-[username]")]),e._v(" pod by navigating to it from the DeploymentConfig and then selecting "),s("code",[e._v("Pods")])])]),e._v(" "),s("p",[s("img",{attrs:{src:o(420),alt:""}}),e._v(" "),s("img",{attrs:{src:o(421),alt:""}})]),e._v(" "),s("ul",[s("li",[s("p",[e._v("Reduce the CPU (request and limit) to "),s("code",[e._v("65 millicores")]),e._v(" and Memory (request and limits) to "),s("code",[e._v("100 Megabytes")]),e._v(" and monitor the startup time of the pod")]),e._v(" "),s("div",{staticClass:"language-oc:cli extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("oc -n [-dev] set resources deployment/rocketchat-[username] --requests=cpu=65m,memory=100Mi --limits=cpu=65m,memory=100Mi\n")])])])]),e._v(" "),s("li",[s("p",[e._v("Monitor the startup events of your pod and measure the time it takes to start")]),e._v(" "),s("div",{staticClass:"language-oc:cli extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("# Restart deployment; and observe\noc -n [-dev] rollout restart deployment/rocketchat-[username]\n\n# Wait for deployment to finish\ntime oc -n [-dev] rollout restart deployment/rocketchat-[username]\n")])])]),s("blockquote",[s("p",[e._v("you may notice your pod starts to crash loop. This is most likely because the "),s("code",[e._v("liveness")]),e._v(" probe you added from an earlier lab is timing out. This is an important consideration when deciding to tune pod resources. It is always a balance.")])])]),e._v(" "),s("li",[s("p",[e._v("Remove the limits previously imposed, and set your pod to "),s("code",[e._v("1 core")]),e._v(" (or "),s("code",[e._v("1000 millicores")]),e._v(") for the request and limit")]),e._v(" "),s("div",{staticClass:"language-oc:cli extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("oc -n [-dev] set resources deployment/rocketchat-[username] --requests=cpu=1000m,memory=512Mi --limits=cpu=1000m,memory=1024Mi\n")])])])]),e._v(" "),s("li",[s("p",[e._v("Monitor the status and speed of the new deployment")]),e._v(" "),s("div",{staticClass:"language-oc:cli extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("# Start new deployment; and\noc -n [-dev] rollout restart deployment/rocketchat-[username]\n\n# Wait for deployment to finish\ntime oc -n [-dev] rollout restart deployment/rocketchat-[username]\n")])])])])]),e._v(" "),s("h2",{attrs:{id:"sharing-resources"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sharing-resources"}},[e._v("#")]),e._v(" Sharing Resources")]),e._v(" "),s("p",[e._v("If there are many team members (and therefor workloads) working together in the same namespace there is a chance that requesting 1 core of cpu and 1 core of memory will not work. Why could that be?")]),e._v(" "),s("ul",[s("li",[e._v("Reset resources utilization to something more appropriate")])]),e._v(" "),s("div",{staticClass:"language-oc:cli extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("oc -n [-dev] set resources deployment/rocketchat-[username] --requests=cpu=150m,memory=256Mi --limits=cpu=200m,memory=400Mi\n")])])]),s("h2",{attrs:{id:"troubleshooting-oom"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting-oom"}},[e._v("#")]),e._v(" Troubleshooting OOM")]),e._v(" "),s("p",[e._v("The dreaded "),s("code",[e._v("OOM")]),e._v(" or Out of Memory is when your pods are utilizing less memory than is required for the containers inside of the pod to work. Often there are "),s("strong",[e._v("no logs")]),e._v(" visible during these issues. Often the symptoms of OOM are "),s("code",[e._v("CrashLoop Back off")]),e._v(" failure events as well as "),s("code",[e._v("rollout")]),e._v(" failures. These can be investigated in the "),s("code",[e._v("Events")]),e._v(" panel. To resolve this you can first increase memory utilization. After that you should investigate if the memory utilization fix is a band-aid or not. In other words, is the application consuming more memory than it should.")])])}),[],!1,null,null,null);t.default=r.exports}}]);