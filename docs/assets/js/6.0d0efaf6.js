(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{422:function(e,t,a){e.exports=a.p+"assets/img/04_app_availability_01.a9c54c0d.png"},423:function(e,t,a){e.exports=a.p+"assets/img/04_app_availability_02.6f418cb7.png"},424:function(e,t,a){e.exports=a.p+"assets/img/04_app_availability_03.8d09474a.png"},425:function(e,t,a){e.exports=a.p+"assets/img/04_app_availability_05.64bae796.png"},426:function(e,t,a){e.exports=a.p+"assets/img/04_app_availability_06.f7171167.png"},484:function(e,t,a){"use strict";a.r(t);var n=a(32),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"application-availability"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#application-availability"}},[e._v("#")]),e._v(" Application Availability")]),e._v(" "),n("p",[e._v("Prior to beginning this lab, navigate to the public route you created and finish the initial setup of your application.\nEnsure to select "),n("code",[e._v("Keep standlone")]),e._v(" on the last page of the initial Rocket.Chat application setup.")]),e._v(" "),n("h3",{attrs:{id:"single-pod-applications"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#single-pod-applications"}},[e._v("#")]),e._v(" Single Pod Applications")]),e._v(" "),n("p",[e._v("Single pod applications are not highly-available and can be abruptly terminated if the pod crashes or due to regularly\nscheduled platform maintenance. In order to simulate the effect on an application:")]),e._v(" "),n("ul",[n("li",[e._v("Navigate to the pod, select "),n("code",[e._v("Actions")]),e._v(" and "),n("code",[e._v("Delete")]),e._v(" "),n("ul",[n("li",[e._v("Select "),n("code",[e._v("Delete pod immediately")])])])])]),e._v(" "),n("p",[n("img",{attrs:{src:a(422),alt:""}})]),e._v(" "),n("p",[n("img",{attrs:{src:a(423),alt:""}})]),e._v(" "),n("ul",[n("li",[e._v("Refresh URL of application")])]),e._v(" "),n("p",[n("img",{attrs:{src:a(424),alt:""}})]),e._v(" "),n("h3",{attrs:{id:"scaling-pods"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#scaling-pods"}},[e._v("#")]),e._v(" Scaling Pods")]),e._v(" "),n("p",[e._v("To increase the availability of an application and defend against unplanned outages or planned maintenance tasks, an\napplication must have multiple pods/instance running. For this reason, stateless applications are desirable as they\ndo not require custom clustering configurations.")]),e._v(" "),n("p",[n("strong",[e._v("Note")]),e._v(' Stateful applications do not support "scaling pods" as a form of high availability. Such a stateful example\nwould be the mongodb database. For this reason, this lab focuses on the rocketchat application which will function\nwith multiple pods. Please refer to specific application documentaion for details on scalability support.')]),e._v(" "),n("ul",[n("li",[e._v("Navigate to "),n("code",[e._v("Topology")]),e._v(" and scale your Deployment by selecting it and pressing "),n("code",[e._v("Actions > Edit Count")]),e._v(" and increasing the count to 2")])]),e._v(" "),n("p",[n("img",{attrs:{src:a(425),alt:""}})]),e._v(" "),n("ul",[n("li",[e._v("Or from the CLI")])]),e._v(" "),n("div",{staticClass:"language-oc:cli extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("oc -n [-dev] scale deployment/rocketchat-[username] --replicas=2\n")])])]),n("ul",[n("li",[n("p",[e._v("Notice the balancing across nodes by exploring the details of each pod\n"),n("img",{attrs:{src:a(426),alt:""}})]),e._v(" "),n("ul",[n("li",[e._v("Or from the CLI notice the hosts the pod runs on (in the last field)")])]),e._v(" "),n("div",{staticClass:"language-oc:cli extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("oc -n [-dev] get pods --field-selector=status.phase=Running -l deployment=rocketchat-[username] -o wide\n")])])]),n("p",[e._v("you can also simply combine with grep:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("oc -n [-dev] get pods -o wide | grep rocketchat-[username]\n")])])]),n("ul",[n("li",[e._v("The output should look similar to this:")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("rocketchat-[username]-7-k6kcc    1/1       Running   0          16m       172.51.68.135   training-aro-us-vmdqq-worker-westus22-kvjdt\nrocketchat-[username]-7-k82w2    0/1       Running   0          1m        172.51.76.32    training-aro-us-vmdqq-worker-westus23-kvjdt\n")])])])]),e._v(" "),n("li",[n("p",[e._v("Delete single pod, refresh the URL of application and notice that the application is served by the surviving pods")]),e._v(" "),n("div",{staticClass:"language-oc:cli extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("oc -n [-dev] get pods --field-selector=status.phase=Running -l deployment=rocketchat-[username] -o name | head -1 | xargs -I {} oc -n [-dev] delete {}\n\nwatch -dg -n 1 curl -fsSL http://rocketchat-[username]-[-dev].[namespace].apps.pathfinder.aro.devops.gov.bc.ca/api/info\n\n# Notice that eventually your RocketChat will be back to having 2 pods\noc -n [-dev] get pods --field-selector=status.phase=Running -l deployment=rocketchat-[username]\n")])])])]),e._v(" "),n("li",[n("p",[e._v("Perform deployment, refresh the URL of application and notice that the application is served by the surviving pods")]),e._v(" "),n("div",{staticClass:"language-oc:cli extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("oc -n [-dev] rollout latest deployment/rocketchat-[username]\n\n# Monitor pods being created and deleted; and\nwatch -dg -n 1 -x oc -n [-dev] get pods -l deployment=rocketchat-[username]\n\n# From another terminal, monitor RocketChat response\nwatch -dg -n 1 curl -fsSL http://rocketchat-[username]-[-dev].[namespace].apps.pathfinder.aro.devops.gov.bc.ca/api/info\n\n")])])])])])])}),[],!1,null,null,null);t.default=s.exports}}]);